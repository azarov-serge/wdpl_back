## Шаг 3: Черновики событий

### Цель шага

- Сконцентрироваться на домене **черновиков событий** (`event_drafts`, `event_day_drafts`).
- Обеспечить безопасное редактирование (организаторы/админы) без влияния на публичный фронт.
- Подготовить модель данных черновиков, совместимую с текущей архитектурой Supabase (`docs/SUPABASE.md`) и будущим Go‑бэкендом.

### Домен черновиков событий

В этом шаге фокус только на **черновиках**:

- **Черновики событий** (`event_drafts`):
  - содержат рабочие версии карточек событий (название, описание, даты и т.п.);
  - могут быть созданы до появления "настоящего" события в публичной таблице;
  - могут существовать независимо от `events` (например, при создании нового мероприятия).
- **Черновики дней событий** (`event_day_drafts`):
  - содержат расписание по дням в удобной для редактирования форме (см. JSONB‑структуру в `docs/SUPABASE.md`);
  - включают детальное расписание (слоты, сессии, спикеры и т.п.), которое может много раз меняться до публикации.

Ключевые свойства домена:

- Допускаются **незавершённые/“грязные” данные** — черновик не обязан быть валидным для фронта.
- Можно сохранять часто (в т.ч. автосохранение) без влияния на публичный фронт.
- Доступ к черновикам ограничен ролями (организаторы/админы/редакторы).

Такой подход:

- исключает утечки незавершённых изменений участникам;
- позволяет редакторам безопасно работать над будущими изменениями до публикации.

### Связь с SUPABASE.md

Текущая реализация на Supabase уже содержит детальное описание доменов `Event`, `EventDraft`, `EventDay`, `EventDayDraft`, а также:

- SQL‑схему таблиц (основные + черновики),
- функции и триггеры для:
  - автоматического обновления `updated_at`,
  - вычисления метаданных для `event_days`,
  - валидации данных.

**На этом шаге**:

- Для Supabase‑MVP можно напрямую использовать схемы и триггеры черновиков из `docs/SUPABASE.md` (`EventDraft`, `EventDayDraft`).
- Для будущего Go‑бэкенда:
  - домены `EventDraft`/`EventDayDraft` будут перенесены в `internal/features/events` как отдельные модели (отличные от `Event`/`EventDay`);
  - RLS‑часть (политики доступа) будет реализована на стороне приложения (middleware/authorizer), а не Supabase.


